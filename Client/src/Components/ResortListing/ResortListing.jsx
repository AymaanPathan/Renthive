import { useEffect, useState } from "react";
import toast from "react-hot-toast";
import { Link } from "react-router-dom";

function ResortListing() {
  const [allData, setAllData] = useState([]);

  const handleAllResort = async () => {
    try {
      const response = await fetch("http://localhost:3000/getAllResorts", {
        headers: { "Content-Type": "application/json" },
      });
      if (response.ok) {
        const data = await response.json();
        setAllData(data.Data);
      } else {
        throw new Error("Failed to fetch resorts");
      }
    } catch (error) {
      console.log(error);
      toast.error("Failed to load resorts. Please try again.");
    }
  };

  useEffect(() => {
    handleAllResort();
  }, []);

  return (
    <div className="resort-listing-container px-6 py-4">
      <h3 className="text-2xl font-semibold text-gray-800 mb-4">
        Resort Listings
      </h3>

      {allData.length > 0 ? (
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
          {allData.map((resort, index) => (
            <div
              key={index}
              className="resort-card w-80 bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow overflow-hidden"
            >
              <img
                src={resort.imageUrl[0]}
                className="w-full h-48 "
                alt="resort-image"
              />
              <div className="p-4 grid ">
                <div className="grid grid-cols-1 items-center justify-start ">
                  <h3 className="text-lg font-semibold text-gray-800">
                    {resort.name}
                  </h3>
                  <div className="flex items-center justify-start gap-2">
                    <svg
                      fill="#FD7E14"
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 30 30"
                      width="20px"
                      height="20px"
                    >
                      <path d="M 15.001953 2 C 14.525703 2 14.048531 2.2322656 13.769531 2.6972656 L 13.226562 3.6035156 C 12.992563 3.9935156 12.607922 4.2569531 12.169922 4.3769531 C 12.164922 4.3779531 12.159297 4.3798594 12.154297 4.3808594 C 11.711297 4.5028594 11.241844 4.4651875 10.839844 4.2421875 L 9.9140625 3.7304688 C 8.9660625 3.2034687 7.79925 3.8769375 7.78125 4.9609375 L 7.7636719 6.03125 C 7.7556719 6.48425 7.554375 6.9046094 7.234375 7.2246094 L 7.2246094 7.234375 C 6.9046094 7.555375 6.48425 7.7566719 6.03125 7.7636719 L 4.9628906 7.78125 C 3.8778906 7.80025 3.2034687 8.9660625 3.7304688 9.9140625 L 4.2441406 10.841797 C 4.4651406 11.240797 4.5018594 11.708437 4.3808594 12.148438 C 4.3788594 12.156437 4.3760469 12.163875 4.3730469 12.171875 C 4.2540469 12.606875 3.9944219 12.990656 3.6074219 13.222656 L 2.6972656 13.767578 C 1.7672656 14.325578 1.7672656 15.673469 2.6972656 16.230469 L 3.6074219 16.775391 C 3.9944219 17.007391 4.2550469 17.391172 4.3730469 17.826172 C 4.3750469 17.834172 4.3778594 17.841609 4.3808594 17.849609 C 4.5018594 18.289609 4.4651406 18.75725 4.2441406 19.15625 L 3.7304688 20.085938 C 3.2044687 21.033938 3.8788906 22.20075 4.9628906 22.21875 L 6.03125 22.236328 C 6.48425 22.244328 6.9046094 22.445625 7.2246094 22.765625 L 7.234375 22.775391 C 7.555375 23.095391 7.7566719 23.51575 7.7636719 23.96875 L 7.78125 25.037109 C 7.79925 26.121109 8.9660625 26.795531 9.9140625 26.269531 L 10.841797 25.753906 C 11.239797 25.532906 11.708437 25.496187 12.148438 25.617188 C 12.156437 25.619187 12.163875 25.622 12.171875 25.625 C 12.606875 25.744 12.990656 26.005578 13.222656 26.392578 L 13.767578 27.300781 C 14.325578 28.230781 15.672469 28.230781 16.230469 27.300781 L 16.775391 26.392578 C 17.007391 26.005578 17.389219 25.743 17.824219 25.625 C 17.832219 25.623 17.841609 25.620188 17.849609 25.617188 C 18.288609 25.496188 18.755297 25.532906 19.154297 25.753906 L 20.082031 26.269531 C 21.030031 26.795531 22.196844 26.121109 22.214844 25.037109 L 22.232422 23.96875 C 22.240422 23.51575 22.441719 23.095391 22.761719 22.775391 L 22.771484 22.765625 C 23.091484 22.444625 23.511844 22.243328 23.964844 22.236328 L 25.035156 22.21875 C 26.119156 22.20075 26.793578 21.033937 26.267578 20.085938 L 25.751953 19.158203 C 25.530953 18.759203 25.494234 18.291562 25.615234 17.851562 C 25.617234 17.843563 25.620047 17.836125 25.623047 17.828125 C 25.742047 17.393125 26.003625 17.009344 26.390625 16.777344 L 27.298828 16.232422 C 28.231828 15.674422 28.231734 14.325578 27.302734 13.767578 L 26.394531 13.222656 C 26.007531 12.990656 25.744953 12.608828 25.626953 12.173828 C 25.624953 12.165828 25.622141 12.156437 25.619141 12.148438 C 25.498141 11.709437 25.534859 11.24275 25.755859 10.84375 L 26.271484 9.9160156 C 26.797484 8.9680156 26.123063 7.8012031 25.039062 7.7832031 L 23.96875 7.765625 C 23.51575 7.757625 23.095391 7.5563281 22.775391 7.2363281 L 22.765625 7.2265625 C 22.444625 6.9065625 22.243328 6.4862031 22.236328 6.0332031 L 22.21875 4.9628906 C 22.19975 3.8768906 21.033938 3.2034687 20.085938 3.7304688 L 19.158203 4.2441406 C 18.760203 4.4651406 18.291562 4.5018594 17.851562 4.3808594 C 17.843563 4.3788594 17.836125 4.3760469 17.828125 4.3730469 C 17.393125 4.2540469 17.009344 3.9944219 16.777344 3.6074219 L 16.232422 2.6972656 C 15.953422 2.2322656 15.478203 2 15.001953 2 z M 11.599609 9.4355469 C 13.172609 9.4355469 14.199219 10.515781 14.199219 12.175781 C 14.199219 13.828781 13.172609 14.916016 11.599609 14.916016 C 10.035609 14.916016 9 13.828781 9 12.175781 C 9 10.522781 10.028609 9.4355469 11.599609 9.4355469 z M 17.255859 9.7011719 L 19.699219 9.7011719 L 15.652344 15.289062 L 12.818359 20.298828 L 10.365234 20.298828 L 14.347656 14.738281 L 17.255859 9.7011719 z M 11.599609 11.015625 C 11.151609 11.015625 10.880859 11.442922 10.880859 12.169922 C 10.880859 12.889922 11.151609 13.322266 11.599609 13.322266 C 12.040609 13.322266 12.3125 12.888922 12.3125 12.169922 C 12.3125 11.435922 12.055609 11.015625 11.599609 11.015625 z M 18.408203 15.083984 C 19.972203 15.083984 21 16.164406 21 17.816406 C 21 19.477406 19.972203 20.5625 18.408203 20.5625 C 16.844203 20.5625 15.816406 19.476406 15.816406 17.816406 C 15.816406 16.164406 16.844203 15.083984 18.408203 15.083984 z M 18.408203 16.664062 C 17.960203 16.664062 17.6875 17.089406 17.6875 17.816406 C 17.6875 18.536406 17.960203 18.970703 18.408203 18.970703 C 18.849203 18.970703 19.119141 18.536406 19.119141 17.816406 C 19.119141 17.081406 18.855203 16.664062 18.408203 16.664062 z" />
                    </svg>
                    <p className="text-gray-600 mt-1">
                      â‚¹ {resort.price} / per night
                    </p>
                  </div>
                  <div className="flex items-center justify-start">
                    <div className="flex items-center justify-start gap-2">
                      <svg
                        fill="#FD7E14"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        width="24px"
                        height="24px"
                      >
                        <path d="M 5 5 C 3.3550302 5 2 6.3550302 2 8 L 2 10.833984 C 1.4019036 11.384041 1 12.131995 1 13 L 1 17.832031 A 1.0001 1.0001 0 0 0 1 18.158203 L 1 20 A 1.0001 1.0001 0 1 0 3 20 L 3 19 L 21 19 L 21 20 A 1.0001 1.0001 0 1 0 23 20 L 23 18.167969 A 1.0001 1.0001 0 0 0 23 17.841797 L 23 13 C 23 12.131995 22.598096 11.384041 22 10.833984 L 22 8 C 22 6.3550302 20.64497 5 19 5 L 14 5 C 13.223035 5 12.535366 5.3416196 12 5.8339844 C 11.464634 5.3416196 10.776965 5 10 5 L 5 5 z M 5 7 L 10 7 C 10.56503 7 11 7.4349698 11 8 L 11 10 L 4 10 L 4 8 C 4 7.4349698 4.4349698 7 5 7 z M 14 7 L 19 7 C 19.56503 7 20 7.4349698 20 8 L 20 10 L 13 10 L 13 8 C 13 7.4349698 13.43497 7 14 7 z M 4 12 L 11.832031 12 A 1.0001 1.0001 0 0 0 11.916016 12.009766 A 1.0001 1.0001 0 0 0 12.115234 12.007812 A 1.0001 1.0001 0 0 0 12.158203 12 L 20 12 C 20.56503 12 21 12.43497 21 13 L 21 17 L 3 17 L 3 13 C 3 12.43497 3.4349698 12 4 12 z" />
                      </svg>
                      <p className="mt-1 text-xs ">{resort.roomTypes}</p>
                    </div>
                  </div>
                  <div className="flex items-center justify-start gap-2">
                    <svg
                      fill="#FD7E14"
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 24 24"
                      width="24px"
                      height="24px"
                    >
                      <path d="M 3.5 4 A 0.50005 0.50005 0 1 0 3.5 5 L 5.5214844 5 A 0.50005 0.50005 0 1 0 5.5214844 4 L 3.5 4 z M 9.5 4 A 0.50005 0.50005 0 1 0 9.5 5 L 21 5 A 0.50005 0.50005 0 1 0 21 4 L 9.5 4 z M 3.5429688 9 A 0.50005 0.50005 0 1 0 3.5429688 10 L 5.5214844 10 A 0.50005 0.50005 0 1 0 5.5214844 9 L 3.5429688 9 z M 9.5 9 A 0.50005 0.50005 0 1 0 9.5 10 L 21 10 A 0.50005 0.50005 0 1 0 21 9 L 9.5 9 z M 3.5429688 14 A 0.50005 0.50005 0 1 0 3.5429688 15 L 5.5214844 15 A 0.50005 0.50005 0 1 0 5.5214844 14 L 3.5429688 14 z M 9.5 14 A 0.50005 0.50005 0 1 0 9.5 15 L 21 15 A 0.50005 0.50005 0 1 0 21 14 L 9.5 14 z M 3.5 19 A 0.50005 0.50005 0 1 0 3.5 20 L 5.4785156 20 A 0.50005 0.50005 0 1 0 5.4785156 19 L 3.5 19 z M 9.5 19 A 0.50005 0.50005 0 1 0 9.5 20 L 21 20 A 0.50005 0.50005 0 1 0 21 19 L 9.5 19 z" />
                    </svg>
                    <p className="mt-1 text-xs text-gray-400">
                      Category/ {resort.category}
                    </p>
                  </div>
                </div>
                <Link to={`/getResort/${resort._id}`}>
                  <button className="mt-4 px-4 py-2 text-white bg-[#E08F71] rounded-full hover:bg-[#d07a5b] transition-colors">
                    View Resort
                  </button>
                </Link>
              </div>
            </div>
          ))}
        </div>
      ) : (
        <p className="text-gray-500 text-center mt-4">
          No resorts available at the moment.
        </p>
      )}
    </div>
  );
}

export default ResortListing;
